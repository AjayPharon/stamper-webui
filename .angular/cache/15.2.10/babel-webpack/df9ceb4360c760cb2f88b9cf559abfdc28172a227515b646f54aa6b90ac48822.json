{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/aj_ph/Documents/Esi/stamper-webui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CBSignImage } from '../Context/CBSignImage';\nimport { lastValueFrom } from 'rxjs';\nimport { environment as env } from '../../environments/environment';\nimport { CBDocumentImage } from '../Context/CBDocumentImage';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../_services/httpConnectService.service\";\nimport * as i2 from \"./../_services/common.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"angular2-draggable\";\nimport * as i5 from \"primeng/button\";\nimport * as i6 from \"primeng/api\";\nimport * as i7 from \"primeng/fileupload\";\nimport * as i8 from \"primeng/galleria\";\nimport * as i9 from \"@angular/forms\";\nfunction SignStamperComponent_ng_template_7_ng_container_7_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵlistener(\"endOffset\", function SignStamperComponent_ng_template_7_ng_container_7_div_1_Template_div_endOffset_0_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const component_r5 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r7.onMoveEnd($event, component_r5));\n    })(\"rzResizing\", function SignStamperComponent_ng_template_7_ng_container_7_div_1_Template_div_rzResizing_0_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const component_r5 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r9.onResizing($event, component_r5));\n    })(\"click\", function SignStamperComponent_ng_template_7_ng_container_7_div_1_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const component_r5 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r10.clickComponent(component_r5));\n    });\n    i0.ɵɵelement(1, \"img\", 29, 30);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const component_r5 = ctx.$implicit;\n    i0.ɵɵnextContext(2);\n    const _r2 = i0.ɵɵreference(1);\n    i0.ɵɵproperty(\"rzAspectRatio\", true)(\"bounds\", _r2)(\"inBounds\", true)(\"rzMinWidth\", 100)(\"rzMaxWidth\", 612)(\"rzMinHeight\", 100)(\"rzMaxHeight\", 792);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"width\", component_r5.signWidth)(\"height\", component_r5.signHeight)(\"src\", component_r5.signContent, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction SignStamperComponent_ng_template_7_ng_container_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, SignStamperComponent_ng_template_7_ng_container_7_div_1_Template, 3, 10, \"div\", 27);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.signImageList);\n  }\n}\nfunction SignStamperComponent_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20, 21)(2, \"img\", 22);\n    i0.ɵɵlistener(\"click\", function SignStamperComponent_ng_template_7_Template_img_click_2_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.showTextFrame($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 23);\n    i0.ɵɵelement(4, \"input\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 25);\n    i0.ɵɵtext(6, \"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, SignStamperComponent_ng_template_7_ng_container_7_Template, 2, 1, \"ng-container\", 26);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", item_r1, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.signVisible);\n  }\n}\nconst _c0 = function () {\n  return {\n    \"max-width\": \"612px\"\n  };\n};\nexport class SignStamperComponent {\n  constructor(httpService, commonService) {\n    this.httpService = httpService;\n    this.commonService = commonService;\n    this.xPosition = 0;\n    this.yPosition = 0;\n    this.scaleX = 100;\n    this.scaleY = 100;\n    this.documentID = \"\";\n    this._activeIndex = 0;\n    this.documentImageList = [];\n    this.signImageList = [];\n    this.signVisible = false;\n    this.images = [];\n    this.size = null;\n    this.zoom = 1.0;\n    this.showImage = false;\n    this.degree = 0;\n    this.showGallery = false;\n    this.position = 'bottom';\n    this.textStamp = '';\n    this.showFrame = false;\n    this.textValue = '';\n    this.frameTop = 0;\n    this.frameLeft = 0;\n    this.responsiveOptions = [{\n      breakpoint: '1024px',\n      numVisible: 5\n    }, {\n      breakpoint: '768px',\n      numVisible: 3\n    }, {\n      breakpoint: '560px',\n      numVisible: 1\n    }];\n  }\n  showTextFrame(event) {\n    this.showFrame = true;\n    this.frameTop = event.clientY;\n    this.frameLeft = event.clientX;\n  }\n  confirmText() {\n    // ทำสิ่งที่คุณต้องการเมื่อผู้ใช้ยืนยันข้อความ\n    console.log('ข้อความที่กรอก:', this.textValue);\n    // ซ่อนกล่องพิมข้อความ\n    this.showFrame = false;\n  }\n  get activeIndex() {\n    return this._activeIndex;\n  }\n  set activeIndex(newValue) {\n    if (this.images && 0 <= newValue && newValue <= this.images.length - 1) {\n      this._activeIndex = newValue;\n    }\n  }\n  ngOnInit() {}\n  onFileSelect(event) {\n    const reader = new FileReader();\n    for (let file of event.files) {\n      reader.readAsDataURL(file);\n      reader.onload = event => {\n        let sign_item = new CBSignImage();\n        sign_item.signContent = reader.result.toString();\n        sign_item.signWidth = this.scaleX;\n        sign_item.signHeight = this.scaleY;\n        sign_item.x = this.xPosition;\n        sign_item.y = this.yPosition;\n        sign_item.pageNumber = this._activeIndex;\n        sign_item.documentID = this.documentID;\n        sign_item.textStamp = this.textStamp;\n        this.signImageList.push(sign_item);\n      };\n    }\n    console.log(this.signImageList);\n    this.signVisible = true;\n  }\n  onFileRemove(event) {\n    event.files.pop();\n  }\n  stamp() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      // let ao_item = new CBSignImage();\n      // ao_item.fileContent = this.signBase64.split(',')[1];\n      // ao_item.scaleX = this.scaleX;\n      // ao_item.scaleY = this.scaleY;\n      // ao_item.xPosition = this.xPosition;\n      // ao_item.yPosition = this.yPosition;\n      console.log(_this.signImageList.at(0)?.x);\n      console.log(_this.signImageList.at(0)?.y);\n      // let payload = new HttpParams().set('requestData', JSON.stringify(this.signImageList))\n      let response = yield lastValueFrom(_this.httpService.ConnectByPOST_JSON(`${env.localhost}/stamper/stampDocument`, _this.signImageList));\n      if (response != null) {\n        console.log('image edited');\n      }\n    })();\n  }\n  documentUpload(event) {\n    const reader = new FileReader();\n    for (let file of event.files) {\n      reader.readAsDataURL(file);\n      reader.onload = event => {\n        this.upload(file, 100);\n        // let document_item = new CBDocumentImage();\n        // document_item.fileContent = reader.result!.toString();\n        // document_item.scaleX = this.scaleX;\n        // document_item.scaleY = this.scaleY;\n        // document_item.xPosition = this.xPosition;\n        // document_item.yPosition = this.yPosition;\n        // document_item.imageId = this.li_CBImage[this.activeIndex].id\n        // this.documentImageList.push(document_item);\n      };\n    }\n  }\n\n  upload(file, ai_letterType) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const methodName = \"multiupload\";\n      console.log(\"START \" + methodName);\n      let urlPath = env.localhost + \"/stamper/convert\";\n      let formData = new FormData();\n      formData.append('file', file);\n      formData.append('filename', file.name);\n      formData.append('letterType', ai_letterType.toString());\n      console.log(\"ทดสอบ\", formData.getAll('file'));\n      try {\n        const response = yield _this2.httpService.ConnectByPOSTFormData(urlPath, formData).toPromise();\n        console.log(\"Upload response:\", response);\n        let documentCB = new CBDocumentImage(_this2.commonService);\n        documentCB.JSONToCB(response);\n        _this2.documentID = documentCB.documentID;\n        _this2.documentImageList = documentCB.imageBase64;\n        console.log('id', _this2.documentID);\n      } catch (error) {\n        console.error(\"Upload error:\", error);\n      }\n    })();\n  }\n  showNextImage() {\n    this._activeIndex++;\n    // this.currentImageIndex = (this.currentImageIndex + 1) % this.li_CBScanImage.length;\n    // for (let i = 0; i < this.documentImageList.length; i++) {\n    //   console.log('image id: ',this.documentImageList.at(i)['imageId']);\n    //   console.log('image index: ',this.activeIndex);\n    //   if (this.documentImageList.at(this.activeIndex) === this.documentImageList.at(i)) {\n    //     this.signVisible = true;\n    //   } else {\n    //     this.signVisible = false;\n    //   }\n    // }\n  }\n\n  showPreviousImage() {\n    this._activeIndex--;\n    // this.currentImageIndex = (this.currentImageIndex - 1 + this.li_CBScanImage.length) % this.li_CBScanImage.length;\n    // for (let i = 0; i < this.documentImageList.length; i++) {\n    //   console.log('image id: ',this.documentImageList.at(i)['imageId']);\n    //   console.log('image index: ',this.activeIndex);\n    //   if (this.documentImageList.at(this.activeIndex) === this.documentImageList.at(i)) {\n    //     this.signVisible = true;\n    //     console.log(this.documentImageList.at(i));\n    //   } else {\n    //     this.signVisible = false;\n    //   }\n    // }\n  }\n\n  clickComponent(component) {\n    console.log('click', component);\n  }\n  onMoveEnd(event, component) {\n    component.x = event.x;\n    component.y = event.y;\n    console.log(event.x, event.y);\n    console.log('index : ', this._activeIndex);\n  }\n  onResizing(event, component) {\n    this.size = event.size;\n    console.log(this.size);\n    component.signWidth = event.size.width;\n    component.signHeight = event.size.height;\n  }\n  static #_ = this.ɵfac = function SignStamperComponent_Factory(t) {\n    return new (t || SignStamperComponent)(i0.ɵɵdirectiveInject(i1.HttpConnectService), i0.ɵɵdirectiveInject(i2.CommonService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SignStamperComponent,\n    selectors: [[\"app-sign-stamper\"]],\n    decls: 24,\n    vars: 18,\n    consts: [[1, \"d-flex\"], [1, \"col-8\"], [1, \"d-flex\", \"justify-content-center\"], [1, \"d-flex\", \"flex-column\"], [1, \"card\"], [3, \"value\", \"showItemNavigators\", \"thumbnailsPosition\", \"showThumbnails\", \"activeIndex\", \"responsiveOptions\", \"containerStyle\", \"numVisible\", \"activeIndexChange\"], [\"pTemplate\", \"item\"], [1, \"d-flex\", \"justify-content-between\"], [\"icon\", \"pi pi-chevron-left\", 3, \"click\"], [\"icon\", \"pi pi-chevron-right\", 3, \"click\"], [1, \"col-3\"], [1, \"col\", \"mt-5\"], [\"name\", \"file[]\", \"accept\", \".pdf\", \"chooseLabel\", \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E40\\u0E2D\\u0E01\\u0E2A\\u0E32\\u0E23\", 3, \"multiple\", \"showUploadButton\", \"showCancelButton\", \"fileLimit\", \"onSelect\", \"onRemove\"], [1, \"mr-2\"], [\"for\", \"stamp\"], [\"id\", \"stamp\", \"type\", \"text\", \"pInputText\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"label\", \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\"], [\"name\", \"file[]\", \"accept\", \"image/*\", \"chooseLabel\", \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E25\\u0E32\\u0E22\\u0E40\\u0E0B\\u0E47\\u0E19\", 3, \"multiple\", \"showUploadButton\", \"showCancelButton\", \"fileLimit\", \"onSelect\", \"onRemove\"], [1, \"mt-2\"], [\"label\", \"Stamp\", 3, \"click\"], [1, \"bg-img\"], [\"mybounds\", \"\"], [\"alt\", \"\\u0E23\\u0E39\\u0E1B\\u0E20\\u0E32\\u0E1E\", 1, \"img-single\", 3, \"src\", \"click\"], [1, \"container\"], [\"contenteditable\", \"true\", \"id\", \"userText\", 1, \"text-input\"], [\"onclick\", \"saveText()\"], [4, \"ngIf\"], [\"ngDraggable\", \"\", \"ngResizable\", \"\", \"rzHandles\", \"n,s,e,w,se,sw\", \"class\", \"sign-img\", 3, \"rzAspectRatio\", \"bounds\", \"inBounds\", \"rzMinWidth\", \"rzMaxWidth\", \"rzMinHeight\", \"rzMaxHeight\", \"endOffset\", \"rzResizing\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"ngDraggable\", \"\", \"ngResizable\", \"\", \"rzHandles\", \"n,s,e,w,se,sw\", 1, \"sign-img\", 3, \"rzAspectRatio\", \"bounds\", \"inBounds\", \"rzMinWidth\", \"rzMaxWidth\", \"rzMinHeight\", \"rzMaxHeight\", \"endOffset\", \"rzResizing\", \"click\"], [3, \"width\", \"height\", \"src\"], [\"targetRef\", \"\"]],\n    template: function SignStamperComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"body\")(1, \"div\", 0)(2, \"div\", 1)(3, \"div\", 2)(4, \"div\", 3)(5, \"div\", 4)(6, \"p-galleria\", 5);\n        i0.ɵɵlistener(\"activeIndexChange\", function SignStamperComponent_Template_p_galleria_activeIndexChange_6_listener($event) {\n          return ctx.activeIndex = $event;\n        });\n        i0.ɵɵtemplate(7, SignStamperComponent_ng_template_7_Template, 8, 2, \"ng-template\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"div\", 7)(9, \"p-button\", 8);\n        i0.ɵɵlistener(\"click\", function SignStamperComponent_Template_p_button_click_9_listener() {\n          return ctx.showPreviousImage();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"p-button\", 9);\n        i0.ɵɵlistener(\"click\", function SignStamperComponent_Template_p_button_click_10_listener() {\n          return ctx.showNextImage();\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(11, \"div\", 10)(12, \"div\", 11)(13, \"p-fileUpload\", 12);\n        i0.ɵɵlistener(\"onSelect\", function SignStamperComponent_Template_p_fileUpload_onSelect_13_listener($event) {\n          return ctx.documentUpload($event);\n        })(\"onRemove\", function SignStamperComponent_Template_p_fileUpload_onRemove_13_listener($event) {\n          return ctx.onFileRemove($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\", 11)(15, \"div\", 13)(16, \"label\", 14);\n        i0.ɵɵtext(17, \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"input\", 15);\n        i0.ɵɵlistener(\"ngModelChange\", function SignStamperComponent_Template_input_ngModelChange_18_listener($event) {\n          return ctx.textStamp = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(19, \"p-button\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 11)(21, \"p-fileUpload\", 17);\n        i0.ɵɵlistener(\"onSelect\", function SignStamperComponent_Template_p_fileUpload_onSelect_21_listener($event) {\n          return ctx.onFileSelect($event);\n        })(\"onRemove\", function SignStamperComponent_Template_p_fileUpload_onRemove_21_listener($event) {\n          return ctx.onFileRemove($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"div\", 18)(23, \"p-button\", 19);\n        i0.ɵɵlistener(\"click\", function SignStamperComponent_Template_p_button_click_23_listener() {\n          return ctx.stamp();\n        });\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"value\", ctx.documentImageList)(\"showItemNavigators\", true)(\"thumbnailsPosition\", ctx.position)(\"showThumbnails\", false)(\"activeIndex\", ctx.activeIndex)(\"responsiveOptions\", ctx.responsiveOptions)(\"containerStyle\", i0.ɵɵpureFunction0(17, _c0))(\"numVisible\", 5);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"multiple\", false)(\"showUploadButton\", false)(\"showCancelButton\", false)(\"fileLimit\", 1);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.textStamp);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"multiple\", true)(\"showUploadButton\", false)(\"showCancelButton\", false)(\"fileLimit\", 5);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.AngularDraggableDirective, i4.AngularResizableDirective, i5.Button, i6.PrimeTemplate, i7.FileUpload, i8.Galleria, i9.DefaultValueAccessor, i9.NgControlStatus, i9.NgModel],\n    styles: [\"@charset \\\"UTF-8\\\";\\n.image-list[_ngcontent-%COMP%] {\\n  display: flex; \\n  flex-wrap: wrap; \\n  gap: 16px; \\n}\\n\\n.image-slider[_ngcontent-%COMP%] {\\n  width: 1700px;\\n  height: 2200px;\\n  border: 1px solid #000000;\\n  overflow: hidden;\\n  cursor: move;\\n  box-sizing: border-box;\\n  transform: scale(100%);\\n  transform: translate(0%, 0%);\\n  display: inline-flex;\\n  z-index: 1;\\n}\\n\\n.img-single[_ngcontent-%COMP%] {\\n  max-width: 100%;\\n  max-height: 100%;\\n}\\n\\nhtml[_ngcontent-%COMP%], body[_ngcontent-%COMP%] {\\n  height: 100%;\\n}\\n\\nbody[_ngcontent-%COMP%] {\\n  margin: 0;\\n  font-family: Roboto, \\\"Helvetica Neue\\\", sans-serif;\\n}\\n\\n.sign-box[_ngcontent-%COMP%] {\\n  position: absolute;\\n  box-sizing: border-box;\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  transform: translate(0%, 0%);\\n}\\n\\n.bg-img[_ngcontent-%COMP%] {\\n  width: 612px;\\n  height: 792px;\\n  border: solid 1px #000000;\\n  top: 0;\\n  left: 0;\\n  cursor: move;\\n  display: inline-flex;\\n  justify-content: center;\\n  align-items: center;\\n  text-align: center;\\n  background: #fff;\\n  z-index: 1;\\n  box-sizing: border-box;\\n}\\n\\n.sign-img[_ngcontent-%COMP%] {\\n  position: absolute;\\n  width: 100px;\\n  height: 100px;\\n  top: 0px;\\n  left: 0px;\\n  transform: translate(0px, 0px);\\n}\\n\\n.chooseButton[_ngcontent-%COMP%] {\\n  display: inline-block;\\n  background-color: indigo;\\n  color: white;\\n  padding: 0.5rem;\\n  font-family: sans-serif;\\n  border-radius: 0.3rem;\\n  cursor: pointer;\\n  margin-top: 1rem;\\n  margin-left: 1rem;\\n}\\n\\n.text-input[_ngcontent-%COMP%] {\\n  width: 300px;\\n  height: 50px;\\n  border: 1px solid #ccc;\\n  padding: 10px;\\n  background-color: transparent;\\n  color: white;\\n  font-size: 16px;\\n  text-align: center;\\n  outline: none;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvc2lnbi1zdGFtcGVyL3NpZ24tc3RhbXBlci5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxnQkFBZ0I7QUFBaEI7RUFDSSxhQUFBLEVBQUEsbUNBQUE7RUFDQSxlQUFBLEVBQUEsa0NBQUE7RUFDQSxTQUFBLEVBQUEsMEJBQUE7QUFFSjs7QUFDRTtFQUlFLGFBQUE7RUFDQSxjQUFBO0VBQ0EseUJBQUE7RUFDQSxnQkFBQTtFQUVBLFlBQUE7RUFDQSxzQkFBQTtFQUNBLHNCQUFBO0VBQ0EsNEJBQUE7RUFDQSxvQkFBQTtFQUNBLFVBQUE7QUFGSjs7QUFLRTtFQUNFLGVBQUE7RUFDQSxnQkFBQTtBQUZKOztBQVFFO0VBQWEsWUFBQTtBQUpmOztBQUtFO0VBQU8sU0FBQTtFQUFXLGlEQUFBO0FBQXBCOztBQUVFO0VBS0Usa0JBQUE7RUFFQSxzQkFBQTtFQUNBLGtCQUFBO0VBQ0EsTUFBQTtFQUNBLE9BQUE7RUFDQSw0QkFBQTtBQUpKOztBQU1FO0VBQ0UsWUFBQTtFQUNBLGFBQUE7RUFDQSx5QkFBQTtFQUVBLE1BQUE7RUFDQSxPQUFBO0VBQ0EsWUFBQTtFQUNBLG9CQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQkFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxVQUFBO0VBQ0Esc0JBQUE7QUFKSjs7QUFRRTtFQUNFLGtCQUFBO0VBQ0EsWUFBQTtFQUNBLGFBQUE7RUFDQSxRQUFBO0VBQ0EsU0FBQTtFQUNBLDhCQUFBO0FBTEo7O0FBUUU7RUFDRSxxQkFBQTtFQUNBLHdCQUFBO0VBQ0EsWUFBQTtFQUNBLGVBQUE7RUFDQSx1QkFBQTtFQUNBLHFCQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0VBQ0EsaUJBQUE7QUFMSjs7QUFRRTtFQUNFLFlBQUE7RUFDQSxZQUFBO0VBQ0Esc0JBQUE7RUFDQSxhQUFBO0VBQ0EsNkJBQUE7RUFDQSxZQUFBO0VBQ0EsZUFBQTtFQUNBLGtCQUFBO0VBQ0EsYUFBQTtBQUxKIiwic291cmNlc0NvbnRlbnQiOlsiLmltYWdlLWxpc3Qge1xyXG4gICAgZGlzcGxheTogZmxleDsgLyogw6DCucKDw6DCuMKrw6DCucKJw6DCuMKjw6DCuMK5w6DCuMKbw6DCuMKgw6DCuMKyw6DCuMKew6DCucKBw6DCuMKqw6DCuMKUw6DCuMKHw6DCucKAw6DCuMKjw6DCuMK1w6DCuMKiw6DCuMKHw6DCuMKVw6DCucKIw6DCuMKtw6DCuMKBw6DCuMKxw6DCuMKZw6DCucKBw6DCuMKZw6DCuMKnw6DCuMKZw6DCuMKtw6DCuMKZICovXHJcbiAgICBmbGV4LXdyYXA6IHdyYXA7IC8qIMOgwrnCg8OgwrjCq8OgwrnCicOgwrjCgsOgwrjCtsOgwrnCicOgwrjCmcOgwrjCmsOgwrjCo8OgwrjCo8OgwrjCl8OgwrjCscOgwrjClMOgwrnCg8OgwrjCq8OgwrjCocOgwrnCiMOgwrnCgMOgwrjCocOgwrjCt8OgwrnCiMOgwrjCrcOgwrjChMOgwrjCo8OgwrjCmsOgwrjCgsOgwrjCmcOgwrjCssOgwrjClCAqL1xyXG4gICAgZ2FwOiAxNnB4OyAvKiDDoMK4wqPDoMK4wrDDoMK4wqLDoMK4wrDDoMK4wqvDoMK5wojDoMK4wrLDoMK4wofDoMK4wqPDoMK4wrDDoMK4wqvDoMK4wqfDoMK5wojDoMK4wrLDoMK4wofDoMK4wqPDoMK4wrnDoMK4wpvDoMK4wqDDoMK4wrLDoMK4wp4gKi9cclxuICB9XHJcbiAgXHJcbiAgLmltYWdlLXNsaWRlciB7XHJcbiAgICAvLyBkaXNwbGF5OiBmbGV4O1xyXG4gICAgLy8gYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIC8vIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICAgIHdpZHRoOiAxNzAwcHg7XHJcbiAgICBoZWlnaHQ6IDIyMDBweDtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMDAwMDA7XHJcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgLy8gcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgY3Vyc29yOiBtb3ZlO1xyXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICAgIHRyYW5zZm9ybTogc2NhbGUoMTAwJSk7XHJcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwJSwgMCUpO1xyXG4gICAgZGlzcGxheTogaW5saW5lLWZsZXg7XHJcbiAgICB6LWluZGV4OiAxO1xyXG4gIH1cclxuICBcclxuICAuaW1nLXNpbmdsZSB7XHJcbiAgICBtYXgtd2lkdGg6IDEwMCU7XHJcbiAgICBtYXgtaGVpZ2h0OiAxMDAlO1xyXG4gICAgLy8gdHJhbnNmb3JtOiBzY2FsZSgwLjUpO1xyXG4gICAgLy8gZGlzcGxheTogYmxvY2s7XHJcbiAgICAvLyBtYXJnaW46IDAgYXV0bztcclxuICB9XHJcbiAgXHJcbiAgaHRtbCwgYm9keSB7IGhlaWdodDogMTAwJTsgfVxyXG4gIGJvZHkgeyBtYXJnaW46IDA7IGZvbnQtZmFtaWx5OiBSb2JvdG8sIFwiSGVsdmV0aWNhIE5ldWVcIiwgc2Fucy1zZXJpZjsgfVxyXG4gIFxyXG4gIC5zaWduLWJveCB7XHJcbiAgICAvLyBjdXJzb3I6IG1vdmU7XHJcbiAgICAvLyBkaXNwbGF5OiBpbmxpbmUtZmxleDtcclxuICAgIC8vIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgLy8gYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgIC8vIHotaW5kZXg6IDE7XHJcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgdG9wOiAwO1xyXG4gICAgbGVmdDogMDtcclxuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAlLCAwJSk7XHJcbiAgfVxyXG4gIC5iZy1pbWcge1xyXG4gICAgd2lkdGg6IDYxMnB4O1xyXG4gICAgaGVpZ2h0OiA3OTJweDtcclxuICAgIGJvcmRlcjogc29saWQgMXB4ICMwMDAwMDA7XHJcbiAgICAvLyBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICB0b3A6IDA7XHJcbiAgICBsZWZ0OiAwO1xyXG4gICAgY3Vyc29yOiBtb3ZlO1xyXG4gICAgZGlzcGxheTogaW5saW5lLWZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBiYWNrZ3JvdW5kOiAjZmZmO1xyXG4gICAgei1pbmRleDogMTtcclxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XHJcbiAgICAvLyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwcHgsIDBweCk7XHJcbiAgfVxyXG4gIFxyXG4gIC5zaWduLWltZyB7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB3aWR0aDogMTAwcHg7XHJcbiAgICBoZWlnaHQ6IDEwMHB4O1xyXG4gICAgdG9wOiAwcHg7XHJcbiAgICBsZWZ0OiAwcHg7XHJcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgwcHgsIDBweCk7XHJcbiAgfVxyXG4gIFxyXG4gIC5jaG9vc2VCdXR0b24ge1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogaW5kaWdvO1xyXG4gICAgY29sb3I6IHdoaXRlO1xyXG4gICAgcGFkZGluZzogMC41cmVtO1xyXG4gICAgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7XHJcbiAgICBib3JkZXItcmFkaXVzOiAwLjNyZW07XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICBtYXJnaW4tdG9wOiAxcmVtO1xyXG4gICAgbWFyZ2luLWxlZnQ6IDFyZW07XHJcbiAgfVxyXG4gIFxyXG4gIC50ZXh0LWlucHV0IHtcclxuICAgIHdpZHRoOiAzMDBweDtcclxuICAgIGhlaWdodDogNTBweDtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgICBwYWRkaW5nOiAxMHB4O1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbiAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBvdXRsaW5lOiBub25lO1xyXG4gIH0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["CBSignImage","lastValueFrom","environment","env","CBDocumentImage","i0","SignStamperComponent","constructor","httpService","commonService","breakpoint","numVisible","showTextFrame","event","showFrame","frameTop","clientY","frameLeft","clientX","confirmText","console","log","textValue","activeIndex","_activeIndex","newValue","images","length","ngOnInit","onFileSelect","reader","FileReader","file","files","readAsDataURL","onload","sign_item","signContent","result","toString","signWidth","scaleX","signHeight","scaleY","x","xPosition","y","yPosition","pageNumber","documentID","textStamp","signImageList","push","signVisible","onFileRemove","pop","stamp","at","response","ConnectByPOST_JSON","localhost","documentUpload","upload","ai_letterType","methodName","urlPath","formData","FormData","append","name","getAll","ConnectByPOSTFormData","toPromise","documentCB","JSONToCB","documentImageList","imageBase64","error","showNextImage","showPreviousImage","clickComponent","component","onMoveEnd","onResizing","size","width","height","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\aj_ph\\Documents\\Esi\\stamper-webui\\src\\app\\sign-stamper\\sign-stamper.component.ts","C:\\Users\\aj_ph\\Documents\\Esi\\stamper-webui\\src\\app\\sign-stamper\\sign-stamper.component.html"],"sourcesContent":["import { CommonService } from './../_services/common.service';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { CBSignImage } from '../Context/CBSignImage';\r\nimport { HttpParams } from '@angular/common/http';\r\nimport { lastValueFrom } from 'rxjs';\r\nimport { HttpConnectService } from '../_services/httpConnectService.service';\r\nimport { environment as env } from '../../environments/environment';\r\nimport { CBDocumentImage } from '../Context/CBDocumentImage';\r\ninterface UploadEvent {\r\n  originalEvent: Event;\r\n  files: File[];\r\n}\r\n\r\n@Component({\r\n  selector: 'app-sign-stamper',\r\n  templateUrl: './sign-stamper.component.html',\r\n  styleUrls: ['./sign-stamper.component.scss']\r\n})\r\n\r\nexport class SignStamperComponent implements OnInit {\r\n  xPosition: number = 0;\r\n  yPosition: number = 0;\r\n  scaleX: number = 100;\r\n  scaleY: number = 100;\r\n  documentID: string = \"\";\r\n  _activeIndex: number = 0;\r\n  documentImageList: any[] = [];\r\n  signImageList: CBSignImage[] = []\r\n  signVisible = false;\r\n  images: any[] = [];\r\n  size: any = null;\r\n  zoom: number = 1.0;\r\n  showImage = false;\r\n  degree: number = 0;\r\n  showGallery = false;\r\n  position: string = 'bottom';\r\n  textStamp: string = '';\r\n\r\n  showFrame = false;\r\n  textValue = '';\r\n  frameTop = 0;\r\n  frameLeft = 0;\r\n\r\n  constructor(   \r\n    private httpService: HttpConnectService,\r\n    private commonService : CommonService) { }\r\n\r\n    showTextFrame(event: MouseEvent) {\r\n      this.showFrame = true;\r\n      this.frameTop = event.clientY;\r\n      this.frameLeft = event.clientX;\r\n    }\r\n  \r\n    confirmText() {\r\n      // ทำสิ่งที่คุณต้องการเมื่อผู้ใช้ยืนยันข้อความ\r\n      console.log('ข้อความที่กรอก:', this.textValue);\r\n  \r\n      // ซ่อนกล่องพิมข้อความ\r\n      this.showFrame = false;\r\n    }\r\n    \r\n  get activeIndex(): number {\r\n    return this._activeIndex;\r\n  }\r\n\r\n  set activeIndex(newValue) {\r\n    if (this.images && 0 <= newValue && newValue <= this.images.length - 1) {\r\n      this._activeIndex = newValue;\r\n    }\r\n  }\r\n\r\n  responsiveOptions: any[] = [\r\n    {\r\n      breakpoint: '1024px',\r\n      numVisible: 5\r\n    },\r\n    {\r\n      breakpoint: '768px',\r\n      numVisible: 3\r\n    },\r\n    {\r\n      breakpoint: '560px',\r\n      numVisible: 1\r\n    }\r\n  ];\r\n  ngOnInit() {\r\n\r\n  }\r\n  onFileSelect(event: UploadEvent) {\r\n    const reader = new FileReader();\r\n    for (let file of event.files) {\r\n      reader.readAsDataURL(file);\r\n      reader.onload = (event) => {\r\n        let sign_item = new CBSignImage();\r\n        sign_item.signContent = reader.result!.toString();\r\n        sign_item.signWidth = this.scaleX;\r\n        sign_item.signHeight = this.scaleY;\r\n        sign_item.x = this.xPosition;\r\n        sign_item.y = this.yPosition;\r\n        sign_item.pageNumber = this._activeIndex;\r\n        sign_item.documentID = this.documentID;\r\n        sign_item.textStamp =  this.textStamp;\r\n        this.signImageList.push(sign_item);\r\n      }\r\n    }\r\n    console.log(this.signImageList);\r\n    \r\n\r\n    this.signVisible = true;\r\n  }\r\n\r\n  onFileRemove(event: UploadEvent) {\r\n    event.files.pop();\r\n  }\r\n\r\n  async stamp() {\r\n    // let ao_item = new CBSignImage();\r\n    // ao_item.fileContent = this.signBase64.split(',')[1];\r\n    // ao_item.scaleX = this.scaleX;\r\n    // ao_item.scaleY = this.scaleY;\r\n    // ao_item.xPosition = this.xPosition;\r\n    // ao_item.yPosition = this.yPosition;\r\n    console.log(this.signImageList.at(0)?.x);\r\n    console.log(this.signImageList.at(0)?.y);\r\n    \r\n    // let payload = new HttpParams().set('requestData', JSON.stringify(this.signImageList))\r\n    let response = await lastValueFrom(this.httpService.ConnectByPOST_JSON(`${env.localhost}/stamper/stampDocument`, this.signImageList));\r\n    if (response != null) {\r\n      console.log('image edited');\r\n    }\r\n  }\r\n  documentUpload(event: UploadEvent) {\r\n    const reader = new FileReader();\r\n    for (let file of event.files) {\r\n      reader.readAsDataURL(file);\r\n      reader.onload = (event) => {\r\n        this.upload(file,100);\r\n        // let document_item = new CBDocumentImage();\r\n        // document_item.fileContent = reader.result!.toString();\r\n        // document_item.scaleX = this.scaleX;\r\n        // document_item.scaleY = this.scaleY;\r\n        // document_item.xPosition = this.xPosition;\r\n        // document_item.yPosition = this.yPosition;\r\n        // document_item.imageId = this.li_CBImage[this.activeIndex].id\r\n        // this.documentImageList.push(document_item);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  async upload(file: File, ai_letterType: number){\r\n    const methodName = \"multiupload\";\r\n    console.log(\"START \" + methodName);\r\n    let urlPath: string = env.localhost + \"/stamper/convert\";\r\n    let formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('filename',file.name)\r\n    formData.append('letterType', ai_letterType.toString());\r\n    console.log(\"ทดสอบ\",formData.getAll('file'));\r\n    try {\r\n        const response = await this.httpService.ConnectByPOSTFormData(urlPath, formData).toPromise();\r\n        console.log(\"Upload response:\", response);\r\n        let documentCB = new CBDocumentImage(this.commonService);\r\n        documentCB.JSONToCB(response);\r\n        this.documentID = documentCB.documentID;\r\n        this.documentImageList = documentCB.imageBase64;\r\n        console.log('id' , this.documentID);\r\n        \r\n    } catch (error) {\r\n        console.error(\"Upload error:\", error);\r\n    }\r\n  }\r\n\r\n  showNextImage() {\r\n    this._activeIndex++;\r\n    // this.currentImageIndex = (this.currentImageIndex + 1) % this.li_CBScanImage.length;\r\n\r\n    // for (let i = 0; i < this.documentImageList.length; i++) {\r\n    //   console.log('image id: ',this.documentImageList.at(i)['imageId']);\r\n    //   console.log('image index: ',this.activeIndex);\r\n    //   if (this.documentImageList.at(this.activeIndex) === this.documentImageList.at(i)) {\r\n    //     this.signVisible = true;\r\n    //   } else {\r\n    //     this.signVisible = false;\r\n    //   }\r\n    // }\r\n  }\r\n\r\n  showPreviousImage() {\r\n    this._activeIndex--;\r\n    // this.currentImageIndex = (this.currentImageIndex - 1 + this.li_CBScanImage.length) % this.li_CBScanImage.length;\r\n    // for (let i = 0; i < this.documentImageList.length; i++) {\r\n    //   console.log('image id: ',this.documentImageList.at(i)['imageId']);\r\n    //   console.log('image index: ',this.activeIndex);\r\n    //   if (this.documentImageList.at(this.activeIndex) === this.documentImageList.at(i)) {\r\n    //     this.signVisible = true;\r\n    //     console.log(this.documentImageList.at(i));\r\n\r\n\r\n    //   } else {\r\n    //     this.signVisible = false;\r\n    //   }\r\n    // }\r\n  }\r\n\r\n  clickComponent(component: CBSignImage) {\r\n    console.log('click', component);\r\n  }\r\n\r\n  onMoveEnd(event: any, component: CBSignImage) {\r\n    component.x = event.x;\r\n    component.y = event.y;\r\n    console.log(event.x, event.y);\r\n    console.log('index : ', this._activeIndex);\r\n  }\r\n\r\n  onResizing(event: any, component: CBSignImage) {\r\n    this.size = event.size;\r\n    console.log(this.size);\r\n    component.signWidth = event.size.width;\r\n    component.signHeight = event.size.height;\r\n  }\r\n}\r\n","<body>\r\n  <div class=\"d-flex\">\r\n    <div class=\"col-8\">\r\n      <div class=\"d-flex justify-content-center\">\r\n        <div class=\"d-flex flex-column \">\r\n          <div class=\"card\">\r\n            <p-galleria [value]=\"documentImageList\" [showItemNavigators]=\"true\" [thumbnailsPosition]=\"position\"\r\n              [showThumbnails]=\"false\" [(activeIndex)]=\"activeIndex\" [responsiveOptions]=\"responsiveOptions\"\r\n              [containerStyle]=\"{ 'max-width': '612px' }\" [numVisible]=\"5\">\r\n              <ng-template pTemplate=\"item\" let-item>\r\n                <div class=\"bg-img\" #mybounds>\r\n                  <img class=\"img-single\" [src]=\"item\" alt=\"รูปภาพ\" (click)=\"showTextFrame($event)\">\r\n\r\n                  <div class=\"container\">\r\n                    <input class=\"text-input\" contenteditable=\"true\" id=\"userText\">\r\n                  </div>\r\n                  <button onclick=\"saveText()\">บันทึกข้อความ</button>\r\n\r\n                  <ng-container *ngIf=\"this.signVisible\">\r\n                    <div *ngFor=\"let component of this.signImageList\" ngDraggable ngResizable [rzAspectRatio]=\"true\"\r\n                      rzHandles=\"n,s,e,w,se,sw\" class=\"sign-img\" [bounds]=\"mybounds\" [inBounds]=\"true\"\r\n                      (endOffset)=\"onMoveEnd($event, component)\" (rzResizing)=\"onResizing($event, component)\"\r\n                      [rzMinWidth]=\"100\" [rzMaxWidth]=\"612\" [rzMinHeight]=\"100\" [rzMaxHeight]=\"792\"\r\n                      (click)=\"clickComponent(component)\">\r\n                      <img [width]=\"component.signWidth\" [height]=\"component.signHeight\" [src]=\"component.signContent\"\r\n                        #targetRef>\r\n                    </div>\r\n                  </ng-container>\r\n                </div>\r\n                <!-- <img [src]=\"item.imageBase64\" style=\"width: 100%; min-height: 792px; display: block;\" />\r\n                      <ng-container *ngIf=\"this.signVisible\">\r\n                        <div *ngFor=\"let component of this.documentImageList\" ngDraggable ngResizable [rzAspectRatio]=\"true\"\r\n                          rzHandles=\"n,s,e,w,se,sw\" class=\"sign-img\" [bounds]=\"mybounds\" [inBounds]=\"true\"\r\n                          (endOffset)=\"onMoveEnd($event, component)\" (rzResizing)=\"onResizing($event, component)\" [rzMinWidth]=\"100\" [rzMaxWidth]=\"612\"\r\n                          [rzMinHeight]=\"100\" [rzMaxHeight]=\"792\" (click)=\"clickComponent(component)\">\r\n                          <img [width]=\"component.scaleX\" [height]=\"component.scaleY\" [src]=\"component.fileContent\" #targetRef>\r\n                        </div>\r\n                      </ng-container> -->\r\n              </ng-template>\r\n              <!-- <ng-template pTemplate=\"thumbnail\" let-item>\r\n                  <div class=\"grid grid-nogutter justify-content-center\">\r\n                    <img [src]=\"item\" style=\"width: auto; height: 100px;\" />\r\n                  </div>\r\n                </ng-template> -->\r\n            </p-galleria>\r\n          </div>\r\n          <!-- <div class=\"bg-img\" #mybounds>\r\n              <img class=\"img-single\" *ngIf=\"showImage\" [src]=\"li_CBScanImage[currentImageIndex].imageBase64\"\r\n                alt=\"รูปภาพ\" [style.scale]=\"zoom\" [style.rotate.deg]=\"degree\">\r\n              <ng-container *ngIf=\"this.signVisible\">\r\n                <div *ngFor=\"let component of this.documentImageList\" ngDraggable ngResizable [rzAspectRatio]=\"true\"\r\n                  rzHandles=\"n,s,e,w,se,sw\" class=\"sign-img\" [bounds]=\"mybounds\" [inBounds]=\"true\"\r\n                  (endOffset)=\"onMoveEnd($event, component)\" (rzResizing)=\"onResizing($event, component)\" [rzMinWidth]=\"100\" [rzMaxWidth]=\"612\"\r\n                  [rzMinHeight]=\"100\" [rzMaxHeight]=\"792\" (click)=\"clickComponent(component)\">\r\n                  <img [width]=\"component.scaleX\" [height]=\"component.scaleY\" [src]=\"component.fileContent\" #targetRef>\r\n                </div>\r\n              </ng-container>\r\n            </div> -->\r\n\r\n          <div class=\"d-flex justify-content-between\">\r\n            <p-button icon=\"pi pi-chevron-left\" (click)=\"showPreviousImage()\"></p-button>\r\n            <p-button icon=\"pi pi-chevron-right\" (click)=\"showNextImage()\"></p-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- <div>\r\n          <p-dialog class=\"pnDialog\" header=\"เพิ่มลายเซ็น\" [(visible)]=\"DisplaySignDialog\" [modal]=\"true\"\r\n            [dismissableMask]=\"true\" [draggable]=\"false\" [resizable]=\"false\"\r\n            [breakpoints]=\"{'1200px': '60vw', '800px': '90vw'}\" [style]=\"{width: '40vw'}\">\r\n          </p-dialog>\r\n        </div> -->\r\n    </div>\r\n    <div class=\"col-3\">\r\n      <!-- <div class=\"row mt-5\">\r\n          <label htmlFor=\"documentname\">ชื่อเอกสาร</label>\r\n          <input pInputText id=\"documentname\" aria-describedby=\"documentname-help\" [(ngModel)]=\"documentName\" />\r\n        </div> -->\r\n      <div class=\"col mt-5\">\r\n        <p-fileUpload name=\"file[]\" [multiple]=\"false\" [showUploadButton]=\"false\" [showCancelButton]=\"false\"\r\n          accept=\".pdf\" chooseLabel=\"เพิ่มเอกสาร\" [fileLimit]=\"1\" (onSelect)=\"documentUpload($event)\"\r\n          (onRemove)=\"onFileRemove($event)\"></p-fileUpload>\r\n        <!-- <p-button label=\"Add Signature\" (click)=\"editSignImage()\"></p-button> -->\r\n        <!-- <input type=\"file\" id=\"upload\" (change)=\"handleUpload($event)\" multiple hidden>\r\n          <label class=\"chooseButton\" for=\"upload\">Choose File</label> -->\r\n      </div>\r\n      <div class=\"col mt-5\">\r\n        <div class=\"mr-2\">\r\n          <label for=\"stamp\">เพิ่มข้อความ</label>\r\n        </div>\r\n        <input id=\"stamp\" type=\"text\" pInputText [(ngModel)]=\"textStamp\" />\r\n        <p-button label=\"เพิ่มข้อความ\" ></p-button>\r\n      </div>\r\n      <div class=\"col mt-5\">\r\n        <p-fileUpload name=\"file[]\" [multiple]=\"true\" [showUploadButton]=\"false\" [showCancelButton]=\"false\"\r\n          accept=\"image/*\" chooseLabel=\"เพิ่มลายเซ็น\" [fileLimit]=\"5\" (onSelect)=\"onFileSelect($event)\"\r\n          (onRemove)=\"onFileRemove($event)\"></p-fileUpload>\r\n        <div class=\"mt-2\">\r\n          <p-button label=\"Stamp\" (click)=\"stamp()\"></p-button>\r\n        </div>\r\n        <!-- <p-button label=\"Add Signature\" (click)=\"editSignImage()\"></p-button> -->\r\n        <!-- <input type=\"file\" id=\"upload\" (change)=\"handleUpload($event)\" multiple hidden>\r\n          <label class=\"chooseButton\" for=\"upload\">Choose File</label> -->\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</body>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}